# ğŸš€ IronCore ä¼ä¸šçº§éƒ¨ç½²æŒ‡å—

**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2025-12-02  
**éƒ¨ç½²æ¨¡å¼**: ç”Ÿäº§å°±ç»ªï¼ˆåŒ…å«æ‰€æœ‰P0ä¿®å¤ï¼‰

---

## âœ… å‰ç½®è¦æ±‚

### 1. ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Linux (Ubuntu 22.04+) / macOS / Windows with WSL2
- **CPU**: 4æ ¸ä»¥ä¸Š
- **å†…å­˜**: 8GBä»¥ä¸Š
- **ç£ç›˜**: 50GBä»¥ä¸Š SSD

### 2. è½¯ä»¶ä¾èµ–
```bash
# Rust 1.75+
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# PostgreSQL 14+ æˆ– CockroachDB 23+
# Redis 7.0+
# Docker & Docker Composeï¼ˆæ¨èï¼‰
```

---

## ğŸ“¦ å¿«é€Ÿå¯åŠ¨ï¼ˆDocker Composeï¼‰

### 1. å…‹éš†ä»“åº“
```bash
git clone <repository-url>
cd Rust-Blockchain/IronCore
```

### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
vim .env
```

**å¿…é¡»ä¿®æ”¹çš„é…ç½®**:
```bash
# æ•°æ®åº“è¿æ¥
DATABASE_URL=postgresql://user:password@localhost:26257/ironcore

# Redisè¿æ¥
REDIS_URL=redis://localhost:6379

# JWTå¯†é’¥ï¼ˆç”Ÿæˆéšæœº64å­—ç¬¦ï¼‰
JWT_SECRET=$(openssl rand -hex 32)

# é’±åŒ…ä¸»å¯†é’¥ï¼ˆç”Ÿæˆéšæœº64å­—ç¬¦ï¼‰
WALLET_MASTER_KEY=$(openssl rand -hex 32)
```

### 3. å¯åŠ¨åŸºç¡€è®¾æ–½
```bash
# å¯åŠ¨ PostgreSQL + Redis
docker-compose up -d postgres redis

# ç­‰å¾…æœåŠ¡å°±ç»ª
sleep 10
```

### 4. è¿è¡Œæ•°æ®åº“è¿ç§»
```bash
# å®‰è£… sqlx-cli
cargo install sqlx-cli --no-default-features --features postgres

# è¿è¡Œè¿ç§»
sqlx migrate run
```

### 5. åˆå§‹åŒ–é»˜è®¤é…ç½®
```bash
# ç¼–è¯‘å¹¶è¿è¡Œ
cargo build --release
./target/release/ironcore
```

### 6. éªŒè¯éƒ¨ç½²
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3000/health

# æŸ¥çœ‹Swaggeræ–‡æ¡£
open http://localhost:3000/swagger-ui
```

---

## ğŸ”§ æ‰‹åŠ¨éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

### æ­¥éª¤1: å®‰è£…æ•°æ®åº“

#### é€‰é¡¹A: PostgreSQL
```bash
# Ubuntu
sudo apt update
sudo apt install postgresql-14 postgresql-contrib

# åˆ›å»ºæ•°æ®åº“
sudo -u postgres psql
CREATE DATABASE ironcore;
CREATE USER ironcore WITH PASSWORD 'your-secure-password';
GRANT ALL PRIVILEGES ON DATABASE ironcore TO ironcore;
\q
```

#### é€‰é¡¹B: CockroachDBï¼ˆæ¨èï¼‰
```bash
# ä¸‹è½½
wget https://binaries.cockroachdb.com/cockroach-v23.1.0.linux-amd64.tgz
tar xvzf cockroach-v23.1.0.linux-amd64.tgz
sudo cp cockroach-v23.1.0.linux-amd64/cockroach /usr/local/bin/

# å¯åŠ¨å•èŠ‚ç‚¹
cockroach start-single-node --insecure --listen-addr=localhost:26257 --http-addr=localhost:8080 --background

# åˆ›å»ºæ•°æ®åº“
cockroach sql --insecure -e "CREATE DATABASE ironcore;"
```

### æ­¥éª¤2: å®‰è£…Redis
```bash
# Ubuntu
sudo apt install redis-server

# å¯åŠ¨
sudo systemctl start redis-server
sudo systemctl enable redis-server

# éªŒè¯
redis-cli ping
```

### æ­¥éª¤3: ç¼–è¯‘Rusté¡¹ç›®
```bash
cd IronCore

# æ·»åŠ Redisä¾èµ–ï¼ˆå¦‚æœè¿˜æ²¡æ·»åŠ ï¼‰
cargo add redis tokio-redis regex

# ç¼–è¯‘ï¼ˆReleaseæ¨¡å¼ï¼‰
cargo build --release
```

### æ­¥éª¤4: è¿è¡Œè¿ç§»
```bash
sqlx migrate run
```

### æ­¥éª¤5: åˆå§‹åŒ–è´¹ç‡é…ç½®
```bash
# å¯åŠ¨æœåŠ¡åï¼Œè°ƒç”¨åˆå§‹åŒ–ç«¯ç‚¹
curl -X POST http://localhost:3000/api/fees/initialize
```

### æ­¥éª¤6: å¯åŠ¨æœåŠ¡
```bash
# å‰å°è¿è¡Œï¼ˆæµ‹è¯•ï¼‰
./target/release/ironcore

# åå°è¿è¡Œï¼ˆç”Ÿäº§ï¼‰
nohup ./target/release/ironcore > ironcore.log 2>&1 &
```

---

## ğŸ¯ éªŒè¯éƒ¨ç½²

### 1. åŸºç¡€å¥åº·æ£€æŸ¥
```bash
# æœåŠ¡å¥åº·
curl http://localhost:3000/health

# å“åº”: "OK"
```

### 2. åˆ›å»ºæµ‹è¯•é’±åŒ…
```bash
curl -X POST http://localhost:3000/api/wallets/create-multi \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "chains": ["ETH", "BSC", "SOL"],
    "word_count": 12
  }'
```

### 3. æµ‹è¯•è´¹ç‡è®¡ç®—
```bash
curl -X POST http://localhost:3000/api/fees/calculate \
  -H "Content-Type: application/json" \
  -d '{
    "fee_type": "SwapServiceFee",
    "amount_usd": 1000
  }'
```

### 4. æµ‹è¯•ä½™é¢æŸ¥è¯¢
```bash
curl "http://localhost:3000/api/wallets/0x123.../balance"
```

---

## ğŸ”’ å®‰å…¨æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰å¿…é¡»å®Œæˆï¼š

- [ ] ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†é’¥å’Œå¯†ç 
- [ ] é…ç½®é˜²ç«å¢™ï¼ˆåªå¼€æ”¾å¿…è¦ç«¯å£ï¼‰
- [ ] å¯ç”¨HTTPSï¼ˆNginxåå‘ä»£ç†ï¼‰
- [ ] é…ç½®æ—¥å¿—è„±æ•
- [ ] å¯ç”¨é£æ§ä¸­é—´ä»¶
- [ ] é…ç½®å¤‡ä»½ç­–ç•¥
- [ ] è®¾ç½®ç›‘æ§å’Œå‘Šè­¦
- [ ] è¿›è¡Œæ¸—é€æµ‹è¯•
- [ ] è·å¾—å®‰å…¨å®¡è®¡æŠ¥å‘Š

---

## ğŸ“Š ç”Ÿäº§ç¯å¢ƒæ¶æ„

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Nginx/Caddy   â”‚
                        â”‚  (HTTPS + CORS) â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                â”‚                â”‚
           â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
           â”‚ IronCore â”‚     â”‚ IronCore â”‚     â”‚ IronCore â”‚
           â”‚ Instance â”‚     â”‚ Instance â”‚     â”‚ Instance â”‚
           â”‚    #1    â”‚     â”‚    #2    â”‚     â”‚    #3    â”‚
           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                â”‚                â”‚                â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                â”‚                â”‚
           â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
           â”‚  Redis  â”‚     â”‚  PgSQL  â”‚     â”‚  ImmuDB â”‚
           â”‚ (Locks) â”‚     â”‚  (Data) â”‚     â”‚ (Audit) â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ åå°æœåŠ¡

### è‡ªåŠ¨å¯åŠ¨çš„æœåŠ¡
1. **äº¤æ˜“ç›‘æ§æœåŠ¡** (Transaction Monitor)
   - é—´éš”: 30ç§’
   - åŠŸèƒ½: å›å¡«gas_used, æ›´æ–°ç¡®è®¤æ•°

2. **äº¤æ˜“è‡ªåŠ¨æ¢å¤** (Auto Recovery)
   - é—´éš”: 5åˆ†é’Ÿ
   - åŠŸèƒ½: æ£€æµ‹å¡ä½äº¤æ˜“ï¼Œè‡ªåŠ¨RBF

3. **è·¨é“¾äº‹ä»¶ç›‘å¬** (Cross-Chain Listener)
   - é—´éš”: 30ç§’
   - åŠŸèƒ½: ç›‘å¬æºé“¾å’Œç›®æ ‡é“¾çŠ¶æ€

### æŸ¥çœ‹åå°æœåŠ¡çŠ¶æ€
```bash
# æŸ¥çœ‹æ—¥å¿—
tail -f ironcore.log | grep -E "(Transaction monitor|Auto-recovery|Cross-chain)"
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ— æ³•è¿æ¥æ•°æ®åº“
```bash
# æ£€æŸ¥æ•°æ®åº“æ˜¯å¦è¿è¡Œ
pg_isready -h localhost -p 26257

# æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
psql $DATABASE_URL
```

### é—®é¢˜2: æ— æ³•è¿æ¥Redis
```bash
# æ£€æŸ¥Redisæ˜¯å¦è¿è¡Œ
redis-cli ping

# æ£€æŸ¥ç«¯å£
netstat -an | grep 6379
```

### é—®é¢˜3: Nonceå†²çª
```bash
# æ£€æŸ¥Redisé”
redis-cli KEYS "nonce_lock:*"

# æ¸…é™¤æ‰€æœ‰Nonceé”ï¼ˆç´§æ€¥ï¼‰
redis-cli --scan --pattern "nonce_lock:*" | xargs redis-cli DEL
```

### é—®é¢˜4: ç¼–è¯‘é”™è¯¯
```bash
# æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘
cargo clean
cargo build --release

# æ£€æŸ¥ä¾èµ–
cargo tree
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“è¿æ¥æ± 
```bash
# å¢åŠ è¿æ¥æ•°
DATABASE_MAX_CONNECTIONS=50
```

### 2. RedisæŒä¹…åŒ–
```bash
# redis.conf
appendonly yes
appendfsync everysec
```

### 3. å¢åŠ å·¥ä½œçº¿ç¨‹
```bash
# è®¾ç½®Tokioçº¿ç¨‹æ•°
TOKIO_WORKER_THREADS=8
```

---

## ğŸ”„ å‡çº§æ­¥éª¤

```bash
# 1. å¤‡ä»½æ•°æ®åº“
pg_dump ironcore > backup_$(date +%Y%m%d).sql

# 2. åœæ­¢æœåŠ¡
kill $(cat ironcore.pid)

# 3. æ‹‰å–æ–°ä»£ç 
git pull

# 4. è¿è¡Œæ–°è¿ç§»
sqlx migrate run

# 5. ç¼–è¯‘
cargo build --release

# 6. å¯åŠ¨
./target/release/ironcore
```

---

## ğŸ“ æ”¯æŒ

- **æ–‡æ¡£**: æŸ¥çœ‹ `docs/` ç›®å½•
- **Issues**: GitHub Issues
- **Swagger**: http://localhost:3000/swagger-ui

---

**éƒ¨ç½²å®Œæˆï¼ç³»ç»Ÿç°åœ¨æ˜¯ä¼ä¸šçº§ç”Ÿäº§å°±ç»ªçŠ¶æ€ã€‚**

